{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/ahmetbozyel/Desktop/Ajans-Bee-Panel-Projesi/ajans-bee-platform/src/lib/auth-types.ts"],"sourcesContent":["// ==========================================\n// RBAC Types - Ajans Bee Platform\n// ==========================================\n\n// Roller\nexport type UserRole = 'admin' | 'personel' | 'operasyon'\n\n// Kullanıcı tipi (public.users tablosu)\nexport interface AppUser {\n  id: string\n  email: string\n  full_name: string | null\n  role: UserRole\n  is_active: boolean\n  created_at: string\n  updated_at: string\n}\n\n// Modül erişimleri\nexport type ModuleSlug = \n  | 'dashboard'\n  | 'markalar'\n  | 'teknik-hizmetler'\n  | 'icerik-uret'\n  | 'gunluk-isler'\n  | 'giris-cikis'\n  | 'ayarlar'\n\n// Rol bazlı erişim matrisi\nexport const ROLE_ACCESS: Record<UserRole, ModuleSlug[]> = {\n  admin: ['dashboard', 'markalar', 'teknik-hizmetler', 'icerik-uret', 'gunluk-isler', 'giris-cikis', 'ayarlar'],\n  personel: ['gunluk-isler', 'giris-cikis'],\n  operasyon: ['gunluk-isler', 'giris-cikis', 'teknik-hizmetler']\n}\n\n// Erişim kontrol fonksiyonları\nexport function canAccess(role: UserRole, module: ModuleSlug): boolean {\n  if (role === 'admin') return true\n  return ROLE_ACCESS[role]?.includes(module) ?? false\n}\n\nexport function canEdit(role: UserRole, module: ModuleSlug): boolean {\n  // Admin her şeyi düzenleyebilir\n  if (role === 'admin') return true\n  \n  // Operasyon teknik hizmetleri düzenleyebilir\n  if (role === 'operasyon' && module === 'teknik-hizmetler') return true\n  \n  // Herkes kendi günlük işlerini düzenleyebilir\n  if (module === 'gunluk-isler' || module === 'giris-cikis') return true\n  \n  return false\n}\n\nexport function getDefaultRoute(role: UserRole): string {\n  switch (role) {\n    case 'admin':\n      return '/dashboard'\n    case 'operasyon':\n      return '/gunluk-isler'\n    case 'personel':\n      return '/gunluk-isler'\n    default:\n      return '/gunluk-isler'\n  }\n}\n\n// Task kategorileri\nexport interface TaskCategory {\n  id: string\n  name: string\n  slug: string\n  color: string\n  icon: string\n  sort_order: number\n  is_active: boolean\n}\n\n// Task status - YENİ SİSTEM\nexport type TaskStatus = 'active' | 'paused' | 'completed'\n\n// Günlük iş - YENİ YAPI\nexport interface DailyTask {\n  id: string\n  user_id: string\n  brand_id: string | null\n  category_id: string\n  description: string\n  \n  // Durum\n  status: TaskStatus\n  \n  // Zaman takibi\n  start_time: string\n  end_time: string | null\n  paused_at: string | null\n  total_duration: number  // saniye cinsinden\n  \n  // Revize sayısı\n  revision_count: number\n  \n  // Hangi güne ait\n  work_date: string\n  \n  created_at: string\n  updated_at: string\n  \n  // Relations\n  category?: TaskCategory\n  brand?: { id: string; brand_name: string } | null\n  user?: { id: string; full_name: string }\n}\n\n// Task Revisions\nexport interface TaskRevision {\n  id: string\n  task_id: string\n  revision_number: number\n  start_time: string\n  end_time: string | null\n  duration: number  // saniye\n  created_at: string\n}\n\n// Attendance status types\nexport type AttendanceStatus = 'normal' | 'late' | 'early_leave' | 'absent' | 'leave' | 'remote' | 'holiday'\nexport type LocationType = 'office' | 'home' | 'other' | 'unknown'\nexport type RecordType = 'normal' | 'leave' | 'sick' | 'remote' | 'holiday'\n\n// Giriş/Çıkış\nexport interface Attendance {\n  id: string\n  user_id: string\n  date: string\n  check_in: string | null\n  check_out: string | null\n  notes: string | null\n  created_at: string\n  updated_at: string\n  // Konum bilgileri\n  check_in_lat?: number | null\n  check_in_lng?: number | null\n  check_out_lat?: number | null\n  check_out_lng?: number | null\n  check_in_location_type?: LocationType | null\n  check_out_location_type?: LocationType | null\n  // Durum ve süreler\n  status?: AttendanceStatus | null\n  late_minutes?: number | null\n  overtime_minutes?: number | null\n  early_leave_minutes?: number | null\n  // Kayıt tipi ve admin notları\n  record_type?: RecordType | null\n  admin_notes?: string | null\n  // Açıklamalar\n  late_reason?: string | null\n  overtime_reason?: string | null\n}\n\n// Personel avatar renkleri\nexport const AVATAR_COLORS: Record<string, string> = {\n  'A': 'from-amber-500 to-orange-600',\n  'B': 'from-violet-500 to-purple-600',\n  'E': 'from-rose-500 to-pink-600',\n  'N': 'from-emerald-500 to-teal-600',\n  'Ö': 'from-cyan-500 to-blue-600',\n  'default': 'from-zinc-500 to-zinc-600'\n}\n\n// Kategori renkleri - HER BİRİ FARKLI RENK\nexport const CATEGORY_COLORS: Record<string, { bg: string; text: string; border: string }> = {\n  'tasarim': { bg: 'bg-fuchsia-500/20', text: 'text-fuchsia-400', border: 'border-fuchsia-500/20' },\n  'video': { bg: 'bg-rose-500/20', text: 'text-rose-400', border: 'border-rose-500/20' },\n  'revize': { bg: 'bg-amber-500/20', text: 'text-amber-400', border: 'border-amber-500/20' },\n  'toplanti': { bg: 'bg-blue-500/20', text: 'text-blue-400', border: 'border-blue-500/20' },\n  'arastirma': { bg: 'bg-cyan-500/20', text: 'text-cyan-400', border: 'border-cyan-500/20' },\n  'gelistirme': { bg: 'bg-emerald-500/20', text: 'text-emerald-400', border: 'border-emerald-500/20' },\n  'icerik': { bg: 'bg-violet-500/20', text: 'text-violet-400', border: 'border-violet-500/20' },\n  'destek': { bg: 'bg-orange-500/20', text: 'text-orange-400', border: 'border-orange-500/20' },\n  'genel': { bg: 'bg-slate-500/20', text: 'text-slate-400', border: 'border-slate-500/20' }\n}\n\n// Status badge stilleri\nexport const STATUS_STYLES: Record<TaskStatus, { bg: string; text: string; border: string; icon: string }> = {\n  'active': { \n    bg: 'bg-emerald-500/20', \n    text: 'text-emerald-400', \n    border: 'border-emerald-500/20',\n    icon: 'pulse'\n  },\n  'paused': { \n    bg: 'bg-amber-500/20', \n    text: 'text-amber-400', \n    border: 'border-amber-500/20',\n    icon: 'pause'\n  },\n  'completed': { \n    bg: 'bg-emerald-500/10', \n    text: 'text-emerald-400', \n    border: 'border-emerald-500/20',\n    icon: 'check-circle'\n  }\n}\n"],"names":[],"mappings":"AAAA,6CAA6C;AAC7C,kCAAkC;AAClC,6CAA6C;AAE7C,SAAS;;;;;;;;;;;;;;;;;AAyBF,MAAM,cAA8C;IACzD,OAAO;QAAC;QAAa;QAAY;QAAoB;QAAe;QAAgB;QAAe;KAAU;IAC7G,UAAU;QAAC;QAAgB;KAAc;IACzC,WAAW;QAAC;QAAgB;QAAe;KAAmB;AAChE;AAGO,SAAS,UAAU,IAAc,EAAE,MAAkB;IAC1D,IAAI,SAAS,SAAS,OAAO;IAC7B,OAAO,WAAW,CAAC,KAAK,EAAE,SAAS,WAAW;AAChD;AAEO,SAAS,QAAQ,IAAc,EAAE,MAAkB;IACxD,gCAAgC;IAChC,IAAI,SAAS,SAAS,OAAO;IAE7B,6CAA6C;IAC7C,IAAI,SAAS,eAAe,WAAW,oBAAoB,OAAO;IAElE,8CAA8C;IAC9C,IAAI,WAAW,kBAAkB,WAAW,eAAe,OAAO;IAElE,OAAO;AACT;AAEO,SAAS,gBAAgB,IAAc;IAC5C,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AA+FO,MAAM,gBAAwC;IACnD,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,KAAK;IACL,WAAW;AACb;AAGO,MAAM,kBAAgF;IAC3F,WAAW;QAAE,IAAI;QAAqB,MAAM;QAAoB,QAAQ;IAAwB;IAChG,SAAS;QAAE,IAAI;QAAkB,MAAM;QAAiB,QAAQ;IAAqB;IACrF,UAAU;QAAE,IAAI;QAAmB,MAAM;QAAkB,QAAQ;IAAsB;IACzF,YAAY;QAAE,IAAI;QAAkB,MAAM;QAAiB,QAAQ;IAAqB;IACxF,aAAa;QAAE,IAAI;QAAkB,MAAM;QAAiB,QAAQ;IAAqB;IACzF,cAAc;QAAE,IAAI;QAAqB,MAAM;QAAoB,QAAQ;IAAwB;IACnG,UAAU;QAAE,IAAI;QAAoB,MAAM;QAAmB,QAAQ;IAAuB;IAC5F,UAAU;QAAE,IAAI;QAAoB,MAAM;QAAmB,QAAQ;IAAuB;IAC5F,SAAS;QAAE,IAAI;QAAmB,MAAM;QAAkB,QAAQ;IAAsB;AAC1F;AAGO,MAAM,gBAAgG;IAC3G,UAAU;QACR,IAAI;QACJ,MAAM;QACN,QAAQ;QACR,MAAM;IACR;IACA,UAAU;QACR,IAAI;QACJ,MAAM;QACN,QAAQ;QACR,MAAM;IACR;IACA,aAAa;QACX,IAAI;QACJ,MAAM;QACN,QAAQ;QACR,MAAM;IACR;AACF"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/ahmetbozyel/Desktop/Ajans-Bee-Panel-Projesi/ajans-bee-platform/src/lib/auth-context.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useEffect, useState, ReactNode, useCallback, useMemo, useRef } from 'react'\nimport { createBrowserClient } from '@supabase/ssr'\nimport { User } from '@supabase/supabase-js'\nimport { AppUser, UserRole, canAccess, canEdit, getDefaultRoute, ModuleSlug } from './auth-types'\n\ninterface AuthContextType {\n  authUser: User | null\n  appUser: AppUser | null\n  loading: boolean\n  role: UserRole | null\n  isAdmin: boolean\n  isOperasyon: boolean\n  isPersonel: boolean\n  canAccess: (module: ModuleSlug) => boolean\n  canEdit: (module: ModuleSlug) => boolean\n  getDefaultRoute: () => string\n  signOut: () => Promise<void>\n  refreshUser: () => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [authUser, setAuthUser] = useState<User | null>(null)\n  const [appUser, setAppUser] = useState<AppUser | null>(null)\n  const [loading, setLoading] = useState(true)\n  const initialized = useRef(false)\n  \n  const supabase = useMemo(() => \n    createBrowserClient(\n      process.env.NEXT_PUBLIC_SUPABASE_URL!,\n      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n    ), \n  [])\n\n  const fetchAppUser = useCallback(async (userId: string): Promise<AppUser | null> => {\n    try {\n      console.log('[Auth] Fetching app user...')\n      \n      const { data, error } = await supabase\n        .from('users')\n        .select('*')\n        .eq('id', userId)\n        .single()\n      \n      if (error) {\n        console.error('[Auth] Users error:', error.message)\n        return null\n      }\n      \n      console.log('[Auth] Got user:', data?.email)\n      return data as AppUser\n    } catch (err: any) {\n      console.error('[Auth] Exception:', err?.message)\n      return null\n    }\n  }, [supabase])\n\n  const refreshUser = useCallback(async () => {\n    const { data: { user } } = await supabase.auth.getUser()\n    if (user) {\n      setAuthUser(user)\n      const appUserData = await fetchAppUser(user.id)\n      setAppUser(appUserData)\n    }\n  }, [supabase, fetchAppUser])\n\n  useEffect(() => {\n    if (initialized.current) return\n    initialized.current = true\n\n    const init = async () => {\n      console.log('[Auth] Init start')\n      \n      try {\n        // Get current user\n        const { data: { user }, error } = await supabase.auth.getUser()\n        \n        if (error || !user) {\n          console.log('[Auth] No user')\n          setLoading(false)\n          return\n        }\n        \n        console.log('[Auth] User:', user.email)\n        setAuthUser(user)\n        \n        // Fetch app user data\n        const appUserData = await fetchAppUser(user.id)\n        setAppUser(appUserData)\n        \n        console.log('[Auth] Done')\n        setLoading(false)\n        \n      } catch (err: any) {\n        console.error('[Auth] Error:', err?.message)\n        setLoading(false)\n      }\n    }\n\n    // Listen only for sign out\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((event) => {\n      console.log('[Auth] Event:', event)\n      if (event === 'SIGNED_OUT') {\n        setAuthUser(null)\n        setAppUser(null)\n        setLoading(false)\n      }\n    })\n\n    init()\n\n    return () => subscription.unsubscribe()\n  }, [supabase, fetchAppUser])\n\n  const signOut = useCallback(async () => {\n    await supabase.auth.signOut()\n    setAuthUser(null)\n    setAppUser(null)\n  }, [supabase])\n\n  const role = appUser?.role ?? null\n\n  const value: AuthContextType = {\n    authUser,\n    appUser,\n    loading,\n    role,\n    isAdmin: role === 'admin',\n    isOperasyon: role === 'operasyon',\n    isPersonel: role === 'personel',\n    canAccess: (module: ModuleSlug) => role ? canAccess(role, module) : false,\n    canEdit: (module: ModuleSlug) => role ? canEdit(role, module) : false,\n    getDefaultRoute: () => role ? getDefaultRoute(role) : '/login',\n    signOut,\n    refreshUser\n  }\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}\n"],"names":[],"mappings":"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"}}]
}